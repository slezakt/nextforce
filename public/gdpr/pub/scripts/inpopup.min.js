window.onload=function(){if(0==InPopup.instances.length&&document.getElementById("inpopup"))new InPopup};var InPopup=function(t){InPopup.instances.push(this),void 0===t&&(t={}),this.defaults={id:"inpopup",storagePrefix:"inpopup_",width:"auto",height:"auto",modal:!0,displayMode:"repeat",repeatInterval:5,maxImpressions:null,content:null,closeButton:!0,showOnload:!0,acceptHash:!0,canWillAppear:function(){return!0}},this.options=this.extend(this.defaults,t),this.popup=document.getElementById(this.options.id),this.popup||(this.popup=document.createElement("div"),this.popup.id=this.options.id),this.initCustomEvent(),this.onevent=new CustomEvent("inpopupon"),this.offevent=new CustomEvent("inpopupoff"),this.popup.style.display="none",delete this.defaults;var e=this.getOption("showOnload");if(this.willAppear()){if(this.createPopup(),this.getOption("acceptHash")){window.location.hash=="#"+this.getOption("id")&&(e=!0);var o=this;window.onhashchange=function(){window.location.hash=="#"+o.getOption("id")&&o.showPopup()}}return 1==e&&this.showPopup(),this}};InPopup.prototype.getOption=function(t){var e=t.replace(/([A-Z])/g,"-$1").toLowerCase(),o=this.popup.getAttribute("data-"+e);return"true"==o&&(o=!0),"false"==o&&(o=!1),null==o?this.options[t]:o},InPopup.prototype.createPopup=function(){var t=this.popup.getAttribute("style").split(";"),e="left:50%;top:50px;padding:40px 15px 15px 15px;background-color:#fff;max-width:90%;position:fixed;border:solid 1px #000;z-index:1041;transform:translateX(-50%);";e+="width:"+this.getOption("width")+";height:"+this.getOption("height")+";";for(var o in t)if(t[o]){var i=t[o].split(":"),n=(i=i[0].replace(" ",""))+".+?;";e=e.replace(new RegExp(n,"g"),""),e+=t[o]+";"}if(this.popup.setAttribute("style",e),this.getOption("content")&&(this.popup.innerHTML=this.getOption("content")),1==this.getOption("closeButton")){var p=document.createElement("a");p.setAttribute("style","position:absolute;top:0;right:0;padding:7px 10px;background-color:#000;color:#fff;font-size:16px;text-decoration:none;"),p.href="javascript:void(0)",p.className="close-inpopup",p.innerHTML="&#10005;";var s=this;p.onclick=function(){s.closePopup()},this.popup.appendChild(p)}if(document.body.appendChild(this.popup),1==this.getOption("modal")){var a=document.createElement("div");a.id="inpopup_overlay",a.setAttribute("style","display:none;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgb(0,0,0);opacity:0.5;z-index:1040;filter: alpha(opacity=50);"),document.body.appendChild(a)}},InPopup.prototype.showPopup=function(){document.body.style.overflow="hidden",1==this.getOption("modal")&&(document.getElementById("inpopup_overlay").style.display="block"),document.getElementById(this.getOption("id")).style.display="block",this.setAppearance(),this.popup.dispatchEvent(this.onevent)},InPopup.prototype.closePopup=function(){document.body.style.overflow="auto",1==this.getOption("modal")&&(document.getElementById("inpopup_overlay").style.display="none"),document.getElementById(this.getOption("id")).style.display="none",this.popup.dispatchEvent(this.offevent)},InPopup.prototype.setImpressions=function(){if("repeat"==this.getOption("displayMode")){var t=this.getOption("maxImpressions"),e=window.localStorage.getItem(this.getOption("storagePrefix")+"TotalImp");if(t&&t<=e)window.localStorage.setItem(this.getOption("storagePrefix")+"Imp",0);else{var o=window.localStorage.getItem(this.getOption("storagePrefix")+"Imp");o>=parseInt(this.getOption("repeatInterval"))&&(o=0,window.localStorage.setItem(this.getOption("storagePrefix")+"TotalImp",++e)),window.localStorage.setItem(this.getOption("storagePrefix")+"Imp",++o)}}},InPopup.prototype.extend=function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t},InPopup.prototype.setAppearance=function(){var t=this.getOption("displayMode");"session"==t?window.sessionStorage.setItem(this.getOption("storagePrefix")+"Appeared",!0):"once"==t&&window.localStorage.setItem(this.getOption("storagePrefix")+"Appeared",!0)},InPopup.prototype.willAppear=function(){if(!this.options.canWillAppear())return!1;if(!this.getOption("showOnload"))return!0;this.setImpressions();var t=this.getOption("displayMode");if("session"==t){if(window.sessionStorage.getItem(this.getOption("storagePrefix")+"Appeared"))return!1}else if("once"==t){if(window.localStorage.getItem(this.getOption("storagePrefix")+"Appeared"))return!1}else if("repeat"==t&&"1"!=window.localStorage.getItem(this.getOption("storagePrefix")+"Imp"))return!1;return!0},InPopup.prototype.initCustomEvent=function(){if("function"==typeof window.CustomEvent)return!1;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),o}t.prototype=window.Event.prototype,window.CustomEvent=t},InPopup.instances=[],InPopup.show=function(){InPopup.instances.length>0&&InPopup.instances[0].showPopup()};